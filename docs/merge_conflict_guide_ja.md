# Git マージ競合の解消手順 (例: `run_ai_talk_test_v4.py` のコメント衝突)

VS Code や CLI でベースブランチを取り込んだ際に、次のような競合マーカーが表示されることがあります。

```
<<<<<<< HEAD
#   - endpoint: /api/chat などに切り替えたい場合は OLLAMA_GENERATE_PATH を設定する。
=======
#   - endpoint: /api/chat を選ぶと chat 形式に自動変換される。
>>>>>>> main
```

この表示は **どちらの変更を採用するかを開発者が判断する必要がある** ことを示しています。以下の手順で安全に解消してください。

1. **文意を読み取り、両方を統合すべきか検討する**  
   上記の例では、どちらも正しい説明なのでコメントを統合して残すのが良いでしょう。不要な方を削除する、もしくは内容をまとめた一文に書き換えます。

2. **競合マーカー (`<<<<<<<`, `=======`, `>>>>>>>`) を完全に削除する**  
   最終的にファイル内にマーカーが1つでも残ると、`git add` 時にエラーになります。マーカーと不要な重複行は手動で削除してください。

3. **`git add` → `git status` で競合が解消されたことを確認する**  
   ```bash
   git add run_ai_talk_test_v4.py
   git status
   ```
   `all conflicts fixed` と表示されれば成功です。

4. **動作確認を行い、`git commit` で確定する**  
   競合解消後は動作確認を行ってからマージコミットまたはリベースを完了させましょう。例: `python -m compileall ai_talk run_ai_talk_test_v4.py`

5. **不要な競合を避けるためのコツ**  
   - コメントの内容を整理して、重複する説明は 1 箇所に集約する。
   - ブランチを長期間放置せず、定期的にベースブランチを取り込む。
   - 似た機能の変更を複数人で同時に進める際は、事前にコメントの書き方や配置を共有する。

## 参考: VS Code での作業

VS Code ではエディタ上部に `Accept Current Change` / `Accept Incoming Change` / `Accept Both Changes` ボタンが表示されます。コメントのように内容を統合したい場合は **一度 `Accept Both Changes` を押してから、手でコメントを整形** すると効率的です。

---

競合解消に慣れるまでは時間が掛かりますが、上記手順を繰り返し実践することで確実に対応できるようになります。困ったときは `git merge --abort` で一度作業を戻してから再挑戦してください。
